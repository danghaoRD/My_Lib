pkg load signal
iData = [1716 1727 1795 1655 1821 1793 1696 1837 1869 1887 1880 1899 1919 1928 1953 2036 1890 2015 2023 2070 1893 2092 2137 2059 2168 2192 2202 2195 2203 2249 2140 2291 2301 2339 2348 2358 2383 2401 2425 2418 2426 2451 2465 2497 2504 2511 2520 2533 2619 2571 2604 2615 2583 2582 2625 2651 2613 2621 2667 2674 2628 2646 2651 2640 2660 2685 2657 2591 2631 2602 2639 2559 2595 2558 2559 2579 2495 2543 2529 2517 2527 2531 2505 2487 2529 2507 2500 2476 2465 2443 2425 2403 2368 2389 2368 2365 2327 2320 2318 2301 2257 2251 2234 2227 2190 2054 2156 2164 2128 2109 2090 2069 2036 2016 1992 1956 1957 1831 1936 1894 1877 1838 1840 1813 1826 1821 1776 1771 1754 1741 1704 1730 1715 1673 1680 1635 1644 1621 1617 1612 1599 1631 1634 1597 1573 1547 1580 1607 1546 1557 1319 1532 1548 1585 1520 1483 1464 1560 1532 1501 1407 1532 1471 1487 1492 1519 1473 1520 1511 1522 1536 1522 1537 1568 1567 1605 1623 1643 1638 1664 1682 1686 1685 1727 1752 1751 1766 1765 1805 1811 1799 1845 1877 1874 1908 1935 1995 1960 2000 2075 2027 2059 2121 2171 2133 2137 2155 2157 2192 2237 2114 2216 2255 2175 2283 2312 2225 2359 2383 2333 2400 2421 2435 2423 2468 2471 2505 2516 2505 2517 2524 2594 2609 2603 2569 2600 2633 2640 2622 2624 2638 2698 2649 2633 2623 2666 2654 2680 2663 2759 2614 2634 2620 2571 2556 2467 2591 2569 2464 2568 2565 2416 2538 2528 2507 2505 2507 2525 2505 2495 2464 2463 2443 2425 2393 2411 2397 2354 2379 2343 2344 2335 2286 2245 2239 2214 2207 2179 2156 2157 2113 2108 2080 2068 2079 2006 1999 1992 1959 1957 1923 1856 1871 1853 1699 1850 1852 1809 1769 1770 1760 1744 1717 1717 1718 1694 1680 1674 1648 1626 1640 1612 1610 1621 1608 1575 1557 1592 1452 1560 1538 1432 1551 1513 1423 1567 1519 1375 1549 1539 1359 1525 1501 1485 1490 1488 1483 1503 1501 1484 1508 1493 1539 1529 1564 1563 1553 1605 1646 1594 1651 1665 1659 1664 1673 1703 1840 1740 1739 1772 1538 1839 1823 1743 1902 1916 1889 1909 1956 1941 1962 1993 2016 2052 2056 2084 2103 2116 2138 2138 2153 2183 2189 2233 2250 2258 2292 2283 2325 2363 2351 2366 2375 2474 2444 2483 2510 2551 2522 2511 2515 2511 2536 2495 2567 2574 2554 2584 2621 2612 2623 2612 2620 2607 2646 2658 2633 2623 2673 2661 2698 2634 2590 2653 2628 2606 2588 2596 2575 2565 2629 2557 2569 2567 2513 2409 2510 2528 2487 2498 2416 2507 2475 2465 2452 2460 2437 2415 2376 2369 2371 2336 2324 2309 2294 2263 2257 2226 2194 2210 2171 2158 2130 2115 2111 2027 2078 2014 1908 2008 1974 1854 1927 1925 1912 1887 1871 1855 1821 1816 1811 1783 1780 1760 1717 1715 1693 1718 1691 1687 1646 1669 1625 1589 1607 1589 1663 1563 1536 1616 1631 1581 1536 1534 1563 1456 1584 1530 1476 1535 1517 1514 1536 1503 1503 1487 1479 1480 1469 1503 1461 1498 1519 1532 1513 1504 1544 1542 1575 1566 1615 1614 1652 1667 1639 1653 1667 1703 1705 1783 1754 1680 1779 1792 1708 1843 1863 1775 1887 1912 1806 1943 1957 2006 1999 2019 2039 2061 2073 2079 2128 2168 2177 2186 2209 2228 2234 2255 2259 2293 2313 2351 2353 2373 2409 2409 2403 2431 2488 2475 2479 2558 2533 2519 2540 2532 2408 2575 2546 2428 2595 2658 2503 2583 2628 2568 2656 2673 2643 2639 2649 2657 2645 2638 2641 2642 2623 2615 2587 2590 2588 2577 2593 2545 2560 2567 2530 2545 2525 2523 2516 2511 2529 2495 2487 2537 2431 2453 2414 2395 2404 2381 2366 2344 2331 2285 2310 2268 2245 2214 2213 2226 2189 2157 2151 2119 2129 2147 2092 2031 2038 1995 2040 1955 1960 1914 1926 1782 1879 1835 1840 1826 1800 1794 1799 1765 1736 1744 1714 1719 1719 1657 1653 1664 1650 1606 1601 1599 1608 1624 1576 1601 1523 1565 1567 1554 1521 1523 1611 1554 1509 1495 1407 1542 1568 1455 1503 1512 1471 1504 1493 1311 1503 1492 1404 1519 1508 1503 1535 1552 1519 1557 1591 1603 1610 1659 1668 1655 1705 1771 1718 1731 1783 1770 1795 1799 1795 1827 1891 1731 1894 1919 1815 1933 1981 1911 1995 2010 1981 2050 2067 2079 2119 2147 2151 2199 2195 2208 2183 2247 2255 2284 2273 2347 2351 2341 2377 2373 2407 2473 2476 2459 2445 2415 2519 2521 2485 2552 2574 2599 2496 2600 2569 2644 2591 2605 2674 2599 2649 2640 2639 2654 2624 2627 2640 2672 2658 2619 2593 2595 2621 2606 2587 2608 2630 2581 2561 2561 2432 2516 2505 2511 2531 2399 2487 2502 2476 2459 2446 2450 2440 2420 2401 2374 2372 2367 2333 2353 2300 2310 2308 2215 2232 2216 2251 2187 2156 2157 2170 2122 2051 2057 2035 1895 2003 1990 1953 1951 1912 1899 1882 1856 1836 1832 1833 1785 1788 1770 1734 1719 1705 1703 1701 1677 1689 1659 1639 1637 1605 1614 1642 1595 1550 1596 1599 1604 1568 1560 1537 1532 1537 1343 1583 1527 1779 1535 1546 1540 1536 1500 1510 1493 1467 1479 1495 1472 1502 1508 1545 1556 1542 1531 1560 1568 1558 1610 1617 1632 1641 1641 1722 1685 1717 1793 1803 1738 1778 1599 2047 1816 1736 1849 1939 1711 1907 1909 1771 1963 2010 1999 2033 2031 2078 2100 2102 2098 2165 2166 2184 2201 2211 2231 2281 2281 2317 2277 2335 2329 2426 2384 2399 2515 2336 2436 2459 2368 2535 2569 2482 2511 2552 2494 2568 2566 2559 2593 2627 2629 2622 2585 2594 2639 2669 2632 2641 2639 2657 2663 2701 2625 2609 2627 2595 2598 2597 2570 2608 2596 2586 2448 2546 2550 2463 2504 2487 2556 2509 2483 2463 2476];
%plot(iData);
meanData = mean(iData)
Fs = 10000;
lengData = length(iData);
pData = iData - meanData;
%hold;
plot(pData);
F1 = 70;
F2 = 100;
order = 5;

lowcut = F1*2/Fs;
highcut = F2*2/Fs;

[b,a] = butter(order,lowcut,'low')
filterA = [0.0690217 0.0702348 0.0713179 0.0722466 0.0729904 0.0734976 0.0736836 0.0734976 0.0729904 0.0722466 0.0713179 0.0702348 0.0690217 0.0676977];

lData = filtfilt(b,a,pData);
l2Data = filter2(filterA, pData);

% lData = lowpass(pData, 70, Fs);
hold;
plot(l2Data);
% f = (-lengData/2 : lengData/2-1)*Fs/lengData;
% fftData = fft(pData, lengData);
% figure;
% plot(f, fftshift(fftData));

